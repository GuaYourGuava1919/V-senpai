import{r as w,g as C,c as R,b as a,w as s,d as t,o as j,E as A,e as d,f as r,n as $,h as p,a as f,i as B,j as N,p as P,q as S,t as I,v as z,l as v,m as i}from"./index-CW2LFP52.js";const D={style:{display:"flex","justify-content":"center","align-items":"center",height:"100vh"}},M={style:{display:"flex","justify-content":"center","align-items":"center","margin-top":"10px"}},Z={__name:"SignUpView",setup(T){const e=w({email:"",sid:"",name:"",class:"",pwd:"",pwd_confirm:""}),g=N(),V=C(),m=w(!1),_=/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/,y=/^[0-9]{9}$/,b=/^[\u4e00-\u9fa5]{2,4}$/,x=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,20}$/,u=n=>{v({message:n,type:"warning"})},U=()=>_.test(e.value.email)?y.test(e.value.sid)?b.test(e.value.name)?e.value.class===""?(u("班級未選擇"),!1):x.test(e.value.pwd)?e.value.pwd!==e.value.pwd_confirm?(u("密碼不一致"),!1):!0:(u("密碼不合規定"),!1):(u("姓名格式錯誤或未填寫"),!1):(u("學號格式錯誤或未填寫"),!1):(u("電子郵件格式錯誤或未填寫"),console.log(e.value.email),!1),k=()=>{if(U()){P(V,e.value.email,e.value.pwd).then(async n=>{const l=n.user;await S(I(z,"users",l.uid),{email:e.value.email,sid:e.value.sid,name:e.value.name,class:e.value.class}),v({message:"註冊成功",type:"success"}),g.push("/login")}).catch(n=>{v({message:"註冊失敗",type:"error"}),console.log("註冊失敗",n)});return}else console.log("表單驗證失敗",e.value)};return(n,l)=>{const c=i("el-option"),E=i("el-checkbox"),q=i("el-tooltip"),F=i("el-button"),h=i("router-link");return j(),R("div",D,[a(t(B),{style:{"max-width":"550px","background-color":"#6C63FF"},shadow:"always"},{default:s(()=>[a(t(A),{model:e.value,"label-width":"auto",style:{margin:"20px"}},{default:s(()=>[a(t(d),{label:"電子郵件",required:""},{default:s(()=>[a(t(r),{modelValue:e.value.email,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.email=o)},null,8,["modelValue"])]),_:1}),a(t(d),{label:"學號",required:""},{default:s(()=>[a(t(r),{modelValue:e.value.sid,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.sid=o)},null,8,["modelValue"])]),_:1}),a(t(d),{label:"姓名",required:""},{default:s(()=>[a(t(r),{modelValue:e.value.name,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.name=o)},null,8,["modelValue"])]),_:1}),a(t(d),{label:"班級",required:""},{default:s(()=>[a(t($),{modelValue:e.value.class,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.class=o),placeholder:"請選擇修課班級",clearable:""},{default:s(()=>[a(c,{label:"二甲",value:"二甲"}),a(c,{label:"二乙",value:"二乙"})]),_:1},8,["modelValue"])]),_:1}),a(q,{content:"密碼需至少包含一個大寫字母、一個小寫字母、一個數字，且長度不少於8個字元。",placement:"right"},{default:s(()=>[a(t(d),{label:"密碼",required:""},{default:s(()=>[a(E,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=o=>m.value=o)},{default:s(()=>l[7]||(l[7]=[p("顯示密碼")])),_:1},8,["modelValue"]),a(t(r),{modelValue:e.value.pwd,"onUpdate:modelValue":l[5]||(l[5]=o=>e.value.pwd=o),type:m.value?"text":"password",placeholder:"請輸入密碼",maxlength:20},null,8,["modelValue","type"])]),_:1})]),_:1}),a(t(d),{label:"確認密碼",required:""},{default:s(()=>[a(t(r),{modelValue:e.value.pwd_confirm,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.pwd_confirm=o),type:m.value?"text":"password",placeholder:"請再次確認密碼",maxlength:20},null,8,["modelValue","type"])]),_:1})]),_:1},8,["model"]),f("div",{class:"",style:{display:"flex","justify-content":"center"},onClick:k},[a(F,{round:"",style:{"background-color":"#FFA726",color:"white"}},{default:s(()=>l[8]||(l[8]=[p("註冊")])),_:1})]),f("div",M,[l[10]||(l[10]=f("p",null,"已有帳號？",-1)),a(h,{to:"/login"},{default:s(()=>l[9]||(l[9]=[p("立刻登入")])),_:1})])]),_:1})])}}};export{Z as default};
